/**
 * Configuration for external vulnerability database APIs
 */

export const VULNERABILITY_APIS = {
  NVD: {
    baseUrl: 'https://services.nvd.nist.gov/rest/json/cves/2.0',
    rateLimit: {
      requests: 50,
      window: 30000 // 30 seconds
    },
    timeout: 5000,
    endpoints: {
      search: '/cves/2.0'
    }
  },
  MITRE: {
    baseUrl: 'https://cve.mitre.org/cgi-bin/cvename.cgi',
    timeout: 5000,
    endpoints: {
      lookup: '?name='
    }
  }
};

// Rate limiting configuration
export const RATE_LIMIT_CONFIG = {
  windowMs: 30000, // 30 seconds
  max: 50 // limit each IP to 50 requests per windowMs
};

// Common HTTP request timeouts
export const REQUEST_TIMEOUTS = {
  default: 5000,
  external: 10000
};

// Error messages
export const API_ERROR_MESSAGES = {
  RATE_LIMIT_EXCEEDED: 'Rate limit exceeded. Please try again later.',
  EXTERNAL_API_ERROR: 'Error fetching from external vulnerability database',
  INVALID_CVE_FORMAT: 'Invalid CVE or GHSA ID format',
  SERVICE_UNAVAILABLE: 'External vulnerability service is currently unavailable'
};

// CVE and GHSA ID validation patterns
export const ID_PATTERNS = {
  CVE: /^CVE-\d{4}-\d{4,}$/,
  GHSA: /^GHSA-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}$/i
};