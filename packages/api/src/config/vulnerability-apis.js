/**
 * Configuration for external vulnerability database APIs
 */

export const VULNERABILITY_APIS = {
  NVD: {
    baseUrl: 'https://services.nvd.nist.gov/rest/json/cves/2.0',
    rateLimit: {
      requests: 50,
      window: 30000 // 30 seconds
    },
    timeout: 5000
  },
  MITRE: {
    baseUrl: 'https://cve.mitre.org/cgi-bin/cvename.cgi',
    timeout: 5000
    // Note: MITRE endpoint may require web scraping if a JSON API is not available.
    // The implementation will need to handle this.
  }
};

// Rate limiting configuration
export const RATE_LIMIT_CONFIG = {
  windowMs: 30000, // 30 seconds
  max: 50 // limit each IP to 50 requests per windowMs
};

// Common HTTP request timeouts
export const REQUEST_TIMEOUTS = {
  default: 5000,
  external: 10000
};

// Error messages
export const API_ERROR_MESSAGES = {
  RATE_LIMIT_EXCEEDED: 'Rate limit exceeded for external vulnerability API.',
  EXTERNAL_API_ERROR: 'External vulnerability API returned an error.',
  SERVICE_UNAVAILABLE: 'External vulnerability service is currently unavailable.',
  INVALID_CVE_FORMAT: 'Invalid CVE/GHSA ID format provided.',
};

// CVE and GHSA ID validation patterns
export const ID_PATTERNS = {
  CVE: /^CVE-\d{4}-\d{4,}$/,
  GHSA: /^GHSA(-[a-z0-9]{4}){3}$/i,
};